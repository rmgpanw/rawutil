<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read and (optionally) process a file in chunks — fread_chunked • rawutil</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Read and (optionally) process a file in chunks — fread_chunked" />
<meta property="og:description" content="Works like read_delim_chunked, but is built on
fread. An advantage is that it is simpler to
programmatically read a selection of columns. However, it is much
slower." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rawutil</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rmgpanw/rawutil/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read and (optionally) process a file in chunks</h1>
    <small class="dont-index">Source: <a href='https://github.com/rmgpanw/rawutil/blob/master/R/chunked.R'><code>R/chunked.R</code></a></small>
    <div class="hidden name"><code>fread_chunked.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Works like <code><a href='https://readr.tidyverse.org/reference/read_delim_chunked.html'>read_delim_chunked</a></code>, but is built on
<code><a href='https://Rdatatable.gitlab.io/data.table/reference/fread.html'>fread</a></code>. An advantage is that it is simpler to
programmatically read a selection of columns. However, it is <em>much</em>
slower.</p>
    </div>

    <pre class="usage"><span class='fu'>fread_chunked</span><span class='op'>(</span>
  <span class='va'>file</span>,
  <span class='va'>callback</span>,
  chunk_size <span class='op'>=</span> <span class='fl'>10000</span>,
  progress <span class='op'>=</span> <span class='cn'>TRUE</span>,
  return_chunks <span class='op'>=</span> <span class='cn'>FALSE</span>,
  cmd <span class='op'>=</span> <span class='cn'>NULL</span>,
  sep <span class='op'>=</span> <span class='st'>"auto"</span>,
  sep2 <span class='op'>=</span> <span class='st'>"auto"</span>,
  dec <span class='op'>=</span> <span class='st'>"."</span>,
  quote <span class='op'>=</span> <span class='st'>"\""</span>,
  na.strings <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"datatable.na.strings"</span>, <span class='st'>"NA"</span><span class='op'>)</span>,
  stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span>,
  select <span class='op'>=</span> <span class='cn'>NULL</span>,
  drop <span class='op'>=</span> <span class='cn'>NULL</span>,
  colClasses <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"character"</span><span class='op'>)</span>,
  integer64 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"datatable.integer64"</span>, <span class='st'>"integer64"</span><span class='op'>)</span>,
  <span class='va'>col.names</span>,
  check.names <span class='op'>=</span> <span class='cn'>FALSE</span>,
  encoding <span class='op'>=</span> <span class='st'>"unknown"</span>,
  strip.white <span class='op'>=</span> <span class='cn'>TRUE</span>,
  fill <span class='op'>=</span> <span class='cn'>FALSE</span>,
  blank.lines.skip <span class='op'>=</span> <span class='cn'>FALSE</span>,
  key <span class='op'>=</span> <span class='cn'>NULL</span>,
  index <span class='op'>=</span> <span class='cn'>NULL</span>,
  showProgress <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"datatable.showProgress"</span>, <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,
  data.table <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"datatable.fread.datatable"</span>, <span class='cn'>TRUE</span><span class='op'>)</span>,
  logical01 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"datatable.logical01"</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,
  keepLeadingZeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"datatable.keepLeadingZeros"</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,
  yaml <span class='op'>=</span> <span class='cn'>FALSE</span>,
  tmpdir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>,
  tz <span class='op'>=</span> <span class='st'>""</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>file</th>
      <td><p>File name in working directory, path to file (passed through <code><a href='https://rdrr.io/r/base/path.expand.html'>path.expand</a></code> for convenience), or a URL starting http://, file://, etc. Compressed files with extension <code class="file">.gz</code> and <code class="file">.bz2</code> are supported if the <code>R.utils</code> package is installed.</p></td>
    </tr>
    <tr>
      <th>callback</th>
      <td><p>A callback function to call on each chunk</p></td>
    </tr>
    <tr>
      <th>chunk_size</th>
      <td><p>The number of rows to include in each chunk</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>bool. Display a progress message stating time taken after
each chunk is processed.</p></td>
    </tr>
    <tr>
      <th>return_chunks</th>
      <td><p>bool. Save chunks and return as a single combined data
frame when function completes. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>cmd</th>
      <td><p>A shell command that pre-processes the file; e.g. <code>fread(cmd=paste("grep",word,"filename"))</code>. See Details.</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>The separator between columns. Defaults to the character in the set <code>[,\t |;:]</code> that separates the sample of rows into the most number of lines with the same number of fields. Use <code>NULL</code> or <code>""</code> to specify no separator; i.e. each line a single character column like <code><a href='https://rdrr.io/r/base/readLines.html'>base::readLines</a></code> does.</p></td>
    </tr>
    <tr>
      <th>sep2</th>
      <td><p>The separator <em>within</em> columns. A <code>list</code> column will be returned where each cell is a vector of values. This is much faster using less working memory than <code>strsplit</code> afterwards or similar techniques. For each column <code>sep2</code> can be different and is the first character in the same set above [<code>,\t |;</code>], other than <code>sep</code>, that exists inside each field outside quoted regions in the sample. NB: <code>sep2</code> is not yet implemented.</p></td>
    </tr>
    <tr>
      <th>dec</th>
      <td><p>The decimal separator as in <code><a href='https://rdrr.io/r/utils/read.table.html'>utils::read.csv</a></code>. If not "." (default) then usually ",". See details.</p></td>
    </tr>
    <tr>
      <th>quote</th>
      <td><p>By default (<code>"\""</code>), if a field starts with a double quote, <code>fread</code> handles embedded quotes robustly as explained under <code>Details</code>. If it fails, then another attempt is made to read the field <em>as is</em>, i.e., as if quotes are disabled. By setting <code>quote=""</code>, the field is always read as if quotes are disabled. It is not expected to ever need to pass anything other than \"\" to quote; i.e., to turn it off.</p></td>
    </tr>
    <tr>
      <th>na.strings</th>
      <td><p>A character vector of strings which are to be interpreted as <code>NA</code> values. By default, <code>",,"</code> for columns of all types, including type <code>character</code> is read as <code>NA</code> for consistency. <code>,"",</code> is unambiguous and read as an empty string. To read <code>,NA,</code> as <code>NA</code>, set <code>na.strings="NA"</code>. To read <code>,,</code> as blank string <code>""</code>, set <code>na.strings=NULL</code>. When they occur in the file, the strings in <code>na.strings</code> should not appear quoted since that is how the string literal <code>,"NA",</code> is distinguished from <code>,NA,</code>, for example, when <code>na.strings="NA"</code>.</p></td>
    </tr>
    <tr>
      <th>stringsAsFactors</th>
      <td><p>Convert all character columns to factors?</p></td>
    </tr>
    <tr>
      <th>select</th>
      <td><p>A vector of column names or numbers to keep, drop the rest. <code>select</code> may specify types too in the same way as <code>colClasses</code>; i.e., a vector of <code>colname=type</code> pairs, or a <code>list</code> of <code>type=col(s)</code> pairs. In all forms of <code>select</code>, the order that the columns are specified determines the order of the columns in the result.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>Vector of column names or numbers to drop, keep the rest.</p></td>
    </tr>
    <tr>
      <th>colClasses</th>
      <td><p>As in <code><a href='https://rdrr.io/r/utils/read.table.html'>utils::read.csv</a></code>; i.e., an unnamed vector of types corresponding to the columns in the file, or a named vector specifying types for a subset of the columns by name. The default, <code>NULL</code> means types are inferred from the data in the file. Further, <code>data.table</code> supports a named <code>list</code> of vectors of column names <em>or numbers</em> where the <code>list</code> names are the class names; see examples. The <code>list</code> form makes it easier to set a batch of columns to be a particular class. When column numbers are used in the <code>list</code> form, they refer to the column number in the file not the column number after <code>select</code> or <code>drop</code> has been applied.
    If type coercion results in an error, introduces <code>NA</code>s, or would result in loss of accuracy, the coercion attempt is aborted for that column with warning and the column's type is left unchanged. If you really desire data loss (e.g. reading <code>3.14</code> as <code>integer</code>) you have to truncate such columns afterwards yourself explicitly so that this is clear to future readers of your code.</p></td>
    </tr>
    <tr>
      <th>integer64</th>
      <td><p>"integer64" (default) reads columns detected as containing integers larger than 2^31 as type <code>bit64::integer64</code>. Alternatively, <code>"double"|"numeric"</code> reads as <code><a href='https://rdrr.io/r/utils/read.table.html'>utils::read.csv</a></code> does; i.e., possibly with loss of precision and if so silently. Or, "character".</p></td>
    </tr>
    <tr>
      <th>col.names</th>
      <td><p>A vector of optional names for the variables (columns). The default is to use the header column if present or detected, or if not "V" followed by the column number. This is applied after <code>check.names</code> and before <code>key</code> and <code>index</code>.</p></td>
    </tr>
    <tr>
      <th>check.names</th>
      <td><p>default is <code>FALSE</code>. If <code>TRUE</code> then the names of the variables in the <code>data.table</code> are checked to ensure that they are syntactically valid variable names. If necessary they are adjusted (by <code><a href='https://rdrr.io/r/base/make.names.html'>make.names</a></code>) so that they are, and also to ensure that there are no duplicates.</p></td>
    </tr>
    <tr>
      <th>encoding</th>
      <td><p>default is <code>"unknown"</code>. Other possible options are <code>"UTF-8"</code> and <code>"Latin-1"</code>.  Note: it is not used to re-encode the input, rather enables handling of encoded strings in their native encoding.</p></td>
    </tr>
    <tr>
      <th>strip.white</th>
      <td><p>default is <code>TRUE</code>. Strips leading and trailing whitespaces of unquoted fields. If <code>FALSE</code>, only header trailing spaces are removed.</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>logical (default is <code>FALSE</code>). If <code>TRUE</code> then in case the rows have unequal length, blank fields are implicitly filled.</p></td>
    </tr>
    <tr>
      <th>blank.lines.skip</th>
      <td><p><code>logical</code>, default is <code>FALSE</code>. If <code>TRUE</code> blank lines in the input are ignored.</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>Character vector of one or more column names which is passed to <code><a href='https://Rdatatable.gitlab.io/data.table/reference/setkey.html'>setkey</a></code>. It may be a single comma separated string such as <code>key="x,y,z"</code>, or a vector of names such as <code>key=c("x","y","z")</code>. Only valid when argument <code>data.table=TRUE</code>. Where applicable, this should refer to column names given in <code>col.names</code>.</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>Character vector or list of character vectors of one or more column names which is passed to <code><a href='https://Rdatatable.gitlab.io/data.table/reference/setkey.html'>setindexv</a></code>. As with <code>key</code>, comma-separated notation like <code>index="x,y,z"</code> is accepted for convenience. Only valid when argument <code>data.table=TRUE</code>. Where applicable, this should refer to column names given in <code>col.names</code>.</p></td>
    </tr>
    <tr>
      <th>showProgress</th>
      <td><p><code>TRUE</code> displays progress on the console if the ETA is greater than 3 seconds. It is produced in fread's C code where the very nice (but R level) txtProgressBar and tkProgressBar are not easily available.</p></td>
    </tr>
    <tr>
      <th>data.table</th>
      <td><p>TRUE returns a <code>data.table</code>. FALSE returns a <code>data.frame</code>. The default for this argument can be changed with <code><a href='https://rdrr.io/r/base/options.html'>options(datatable.fread.datatable=FALSE)</a></code>.</p></td>
    </tr>
    <tr>
      <th>logical01</th>
      <td><p>If TRUE a column containing only 0s and 1s will be read as logical, otherwise as integer.</p></td>
    </tr>
    <tr>
      <th>keepLeadingZeros</th>
      <td><p>If TRUE a column containing numeric data with leading zeros will be read as character, otherwise leading zeros will be removed and converted to numeric.</p></td>
    </tr>
    <tr>
      <th>yaml</th>
      <td><p>If <code>TRUE</code>, <code>fread</code> will attempt to parse (using <code><a href='https://rdrr.io/pkg/yaml/man/yaml.load.html'>yaml.load</a></code>) the top of the input as YAML, and further to glean parameters relevant to improving the performance of <code>fread</code> on the data itself. The entire YAML section is returned as parsed into a <code>list</code> in the <code>yaml_metadata</code> attribute. See <code>Details</code>.</p></td>
    </tr>
    <tr>
      <th>tmpdir</th>
      <td><p>Directory to use as the <code>tmpdir</code> argument for any <code>tempfile</code> calls, e.g. when the input is a URL or a shell command. The default is <code><a href='https://rdrr.io/r/base/tempfile.html'>tempdir()</a></code> which can be controlled by setting <code>TMPDIR</code> before starting the R session; see <code><a href='https://rdrr.io/r/base/tempfile.html'>base::tempdir</a></code>.</p></td>
    </tr>
    <tr>
      <th>tz</th>
      <td><p>Relevant to datetime values which have no Z or UTC-offset at the end, i.e. <em>unmarked</em> datetime, as written by <code><a href='https://rdrr.io/r/utils/write.table.html'>utils::write.csv</a></code>. The default <code>tz="UTC"</code> reads unmarked datetime as UTC POSIXct efficiently. <code>tz=""</code> reads unmarked datetime as type character (slowly) so that <code>as.POSIXct</code> can interpret (slowly) the character datetimes in local timezone; e.g. by using <code>"POSIXct"</code> in <code>colClasses=</code>. Note that <code>fwrite()</code> by default writes datetime in UTC including the final Z and therefore <code>fwrite</code>'s output will be read by <code>fread</code> consistently and quickly without needing to use <code>tz=</code> or <code>colClasses=</code>. If the <code>TZ</code> environment variable is set to <code>"UTC"</code> (or <code>""</code> on non-Windows where unset vs `""` is significant) then the R session's timezone is already UTC and <code>tz=""</code> will result in unmarked datetimes being read as UTC POSIXct. For more information, please see the news items from v1.13.0 and v1.14.0.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed on to <code>callback</code> function.</p></td>
    </tr>
    </table>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alasdair Warwick.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


